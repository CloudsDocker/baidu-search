
var request = require('request');
var http = require('http');
var util = require('util')
var cheerio = require('cheerio')
var querystring = require('querystring')

var baseURL="http://www.baidu.com/s?wd=%s&pn=%s"


function callbackMethod(error, response, body) {
  console.log('*. callback function got hit')

  if (!error && response.statusCode == 200) {
    var info = JSON.parse(body);
    console.log(info.stargazers_count + " Stars");
    console.log(info.forks_count + " Forks");
  }
}


function baidu(keyWord,beginPage, callback){
    console.log("* functionalities are under avtive development right now, pleaes be expected this will be ready shortly!")

    var startIndex = 0
    if (typeof callback === 'undefined') {
      callback = beginPage
    } else {
      if(beginPage>0){
        startIndex = (beginPage-1)*10
      }
    }

    var newUrl = util.format(baseURL,keyWord,startIndex)
    console.log('*. new url is :' + newUrl)

    var options = {
      url: newUrl,
      method: 'GET'
    }

    var req = http.request(options, function(res) {
      console.log("333");
    })



    request(options, function(err,resp,body){
      console.log("*.---- Called request");
      if ((err == null) && resp.statusCode === 200) {
        console.log('*. Request returned successfully')
        var $ = cheerio.load(body)
        var res = {
          url: newUrl,
          query: query,
          start: start,
          links: [],
          $: $,
          body: body
        }
      }
      else {
        console.log('*. Error returned');
      }
    })
    console.log('*. Ended')
}

module.exports=baidu
